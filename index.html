<!DOCTYPE html>
<html lang="ar" dir="rtl" data-theme="desert">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ูุธุงู ุฅุฏุงุฑุฉ ุงููุฑูุจุงุช ุงูุนุณูุฑูุฉ</title>
  <meta name="description" content="ุชุทุจูู ููุจ ูุฅุฏุงุฑุฉ ุงููุฑูุจุงุช ุงูุนุณูุฑูุฉ ูุน ุญูุธ ูุญููุ ุชุตุฏูุฑ/ุงุณุชูุฑุงุฏุ ุฅุญุตุงุฆูุงุชุ ุชุฎุตูุต ุฃุนูุฏุฉุ ุจุทุงูุฉ ูุฑูุจุฉุ Virtual Rowsุ ููุงุชุฑ ููุฑุฒุ ูุณุฎ ุงุญุชูุงุทูุ CSVุ PDFุ PWAุ ุฃุฏูุงุฑ ูุณุชุฎุฏูููุ ุชุฑุงุฌุน/ุฅุนุงุฏุฉุ ูุชุญุฏูุฏ ูุชุนุฏุฏ." />
  <link rel="stylesheet" href="styles.css" />
  <!-- ููุชุจุงุช Excel ู PDF -->
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

  <!-- ุชุทุจูู -->
  <script defer src="app.js"></script>
</head>
<body>

  <header>
    <h1>ูุธุงู ุฅุฏุงุฑุฉ ุงููุฑูุจุงุช ุงูุนุณูุฑูุฉ</h1>
    <button id="addBtn" class="add" data-edit-only>โ ุฅุถุงูุฉ</button>
    <button id="exportBtn" class="secondary">โค JSON</button>
    <button id="xlsxExportBtn" class="secondary">โฌ๏ธ Excel</button>
    <button id="xlsxImportBtn" class="secondary" data-edit-only>โฌ๏ธ Excel</button>
    <input id="xlsxFile" type="file" accept=".xlsx" hidden />
    <button id="csvExportBtn" class="secondary">โฌ๏ธ CSV</button>
    <button id="printBtn" class="secondary">๐จ๏ธ ุทุจุงุนุฉ</button>
    <button id="pdfBtn" class="secondary">๐ ุชูุฑูุฑ PDF</button>
    <button id="seedBtn" class="secondary">๐ช ุชุนุจุฆุฉ ุจูุงูุงุช</button>
    <button id="undoBtn" class="secondary" data-edit-only>โถ ุชุฑุงุฌุน</button>
    <button id="redoBtn" class="secondary" data-edit-only>โท ุฅุนุงุฏุฉ</button>
    <button id="bulkBtn" class="secondary" data-edit-only>โ๏ธ ุชุญุฏูุฏ ูุชุนุฏุฏ</button>
    <button id="backupBtn" class="secondary">๐พ ูุณุฎ ุงุญุชูุงุทู</button>
    <button id="restoreBtn" class="secondary">โฉ๏ธ ุงุณุชุฑุฌุงุน</button>
    <button id="colsBtn" class="secondary">โ๏ธ ุงูุฃุนูุฏุฉ</button>
    <button id="themeBtn" class="secondary">๐จ ุงูููุท</button>
    <button id="helpBtn" class="secondary">โจ๏ธ ุงููุณุงุนุฏุฉ</button>
    <span style="margin-inline-start:auto"></span>
    <button id="loginBtn" class="add">๐ ุฏุฎูู</button>
    <button id="logoutBtn" class="secondary hidden">๐ช ุฎุฑูุฌ</button>
    <button id="acctBtn" class="secondary hidden">๐ค ุฅุนุฏุงุฏุงุช ุงูุฃุฏูุงุฑ</button>
  </header>

  <main class="container">
    <input id="q" class="search" placeholder="๐ ุจุญุซ ุณุฑูุน... ุฑูู/ุงุณู/ููุน/ูุญุฏุฉ/ุณุงุฆู" />

    <div id="quickFilters" style="margin:8px 0;display:flex;gap:6px;flex-wrap:wrap">
      <button class="secondary" data-status="">ุงููู</button>
      <button class="secondary" data-status="ุฌุงูุฒุฉ">โ ุฌุงูุฒุฉ</button>
      <button class="secondary" data-status="ุตูุงูุฉ">๐๏ธ ุตูุงูุฉ</button>
      <button class="secondary" data-status="ููุชุดุฑุฉ">๐ ููุชุดุฑุฉ</button>
      <button class="secondary" data-status="ุฎุงุฑุฌ ุงูุฎุฏูุฉ">โ ุฎุงุฑุฌ ุงูุฎุฏูุฉ</button>
      <span id="resCount" style="margin-inline-start:auto;opacity:.7;font-size:12px"></span>
    </div>

    <section class="dashboard" id="dashboardStats"></section>

    <div class="table-wrap" id="tableViewport">
      <table id="vehTable" aria-label="ุฌุฏูู ุงููุฑูุจุงุช">
        <thead><tr id="headerRow"></tr></thead>
        <tbody id="vehTbody"></tbody>
      </table>
    </div>

    <div id="bulkBar" class="bulkbar">
      <span id="bulkCount">0 ูุญุฏุฏ</span>
      <button id="bulkDelete" class="danger" data-edit-only>ุญุฐู ุงููุญุฏุฏ</button>
      <button id="bulkStatusReady" class="secondary" data-edit-only>ุชุนููู: ุฌุงูุฒุฉ</button>
      <button id="bulkStatusMaint" class="secondary" data-edit-only>ุชุนููู: ุตูุงูุฉ</button>
      <button id="bulkStatusDeploy" class="secondary" data-edit-only>ุชุนููู: ููุชุดุฑุฉ</button>
      <button id="bulkStatusOut" class="secondary" data-edit-only>ุชุนููู: ุฎุงุฑุฌ ุงูุฎุฏูุฉ</button>
      <button id="bulkExportCSV" class="secondary">โฌ๏ธ CSV (ุงููุญุฏุฏ)</button>
      <button id="bulkExportXLSX" class="secondary">โฌ๏ธ Excel (ุงููุญุฏุฏ)</button>
    </div>

    <p style="opacity:.7;font-size:12px;margin-top:10px">ุงูุญูุธ ูุญูููุง ุนูู ุฌูุงุฒู. ุงูุชุนุฏููุงุช ุงููุญููุฉ ุชุชุทูุจ ุฏูุฑ "ูุญุฑุฑ" ุฃู "ูุฏูุฑ".</p>
  </main>

  <!-- ูุงูุฐุฉ ุงููููุฐุฌ -->
  <div class="modal" id="formModal" aria-hidden="true">
    <div class="dialog">
      <header>
        <h3>๐ ูุฑูุจุฉ</h3>
        <button id="closeForm" class="secondary">โ</button>
      </header>
      <div class="body">
        <input type="hidden" id="vehId" />
        <div class="form-grid" id="formFields"></div>
      </div>
      <footer>
        <div style="display:flex;gap:8px;flex-wrap:wrap;width:100%">
          <div>
            <button id="prevTab" class="secondary">โฌ๏ธ ุงูุณุงุจู</button>
            <button id="nextTab" class="secondary">ุงูุชุงูู โก๏ธ</button>
          </div>
          <div style="margin-inline-start:auto;display:flex;gap:8px">
            <button id="saveVeh" class="save hidden">โ ุฅููุงุก ูุญูุธ</button>
            <button id="resetForm" class="secondary">ุชูุฑูุบ</button>
          </div>
        </div>
      </footer>
    </div>
  </div>

  <!-- ุชุฎุตูุต ุงูุฃุนูุฏุฉ -->
  <div class="modal" id="colsModal">
    <div class="dialog">
      <header>
        <h3>โ๏ธ ุชุฎุตูุต ุงูุฃุนูุฏุฉ</h3>
        <button id="closeCols" class="secondary">โ</button>
      </header>
      <div class="body">
        <div id="colsForm" style="display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:8px"></div>
        <p id="colsCount" style="margin-top:10px;color:#ddd"></p>
      </div>
      <footer>
        <button id="toggleAll" class="secondary">โ๏ธ ุชุญุฏูุฏ/ุฅูุบุงุก ุงููู</button>
        <button id="saveCols" class="save">โ ุญูุธ</button>
      </footer>
    </div>
  </div>

 <!-- ุจุทุงูุฉ ุงููุฑูุจุฉ -->
<div class="modal" id="cardModal">
  <div class="veh-card-pro">
    <header><h2>๐ชช ุจุทุงูุฉ ุงููุฑูุจุฉ</h2></header>
    <section class="veh-info-grid" id="vehCardInfo"></section>
    <div class="qr-section">
      <div id="qrcode"></div>
      <p>ุงูุณุญ ุงูููุฏ ููุชุญ ุงููุธุงู ูุจุงุดุฑุฉ</p>
    </div>
    <footer style="text-align:center;margin-top:10px">
      <button id="printCard" class="save">๐จ๏ธ ุทุจุงุนุฉ ุงูุจุทุงูุฉ</button>
      <button id="closeCard" class="secondary">โ๏ธ ุฅุบูุงู</button>
    </footer>
  </div>
</div>


  <!-- ููุนุงูุฌ ุงุณุชูุฑุงุฏ Excel -->
  <div class="modal" id="importModal">
    <div class="dialog">
      <header>
        <h3>โฌ๏ธ ููุนุงูุฌ ุงุณุชูุฑุงุฏ Excel</h3>
        <button id="closeImport" class="secondary">โ</button>
      </header>
      <div class="body">
        <div id="importSummary" style="margin-bottom:8px;color:var(--muted)"></div>
        <div id="mapper" class="map-grid"></div>
        <p id="mapHint" class="hint">ูููู ุชุนุฏูู ุฃู ูุทุงุจูุฉ ูุฏูููุง. ุงูุฃุนูุฏุฉ ุบูุฑ ุงููุฑุจูุทุฉ ุณุชูููุฃ ุจููู ูุงุฑุบุฉ.</p>
        <div id="importReport" style="margin-top:8px"></div>
      </div>
      <footer>
        <button id="applyImport" class="save" data-edit-only>ุงุณุชูุฑุงุฏ ูุฏูุฌ</button>
      </footer>
    </div>
  </div>

  <!-- ูุงูุฐุฉ ุงููุณุงุนุฏุฉ -->
  <div class="modal" id="helpModal">
    <div class="dialog">
      <header>
        <h3>โจ๏ธ ุงุฎุชุตุงุฑุงุช ุณุฑูุนุฉ</h3>
        <button class="secondary" onclick="document.getElementById('helpModal').classList.remove('open')">โ</button>
      </header>
      <div class="body" style="line-height:1.9">
        <div> / : ุชุฑููุฒ ุงูุจุญุซ</div>
        <div> n : ุฅุถุงูุฉ ุณุฌู ุฌุฏูุฏ</div>
        <div> Ctrl+S : ุญูุธ ูู ูููุฐุฌ ุงููุฑูุจุฉ</div>
        <div> โ / โ : ุชูููู ุจูู ุชุจููุจุงุช ุงููููุฐุฌ</div>
        <div> ? : ูุชุญ ูุงูุฐุฉ ุงููุณุงุนุฏุฉ</div>
      </div>
    </div>
  </div>

  <!-- ูุงูุฐุฉ ุงูุฏุฎูู -->
  <div class="modal" id="loginModal">
    <div class="dialog">
      <header>
        <h3>๐ ุชุณุฌูู ุงูุฏุฎูู</h3>
        <button id="closeLogin" class="secondary">โ</button>
      </header>
      <div class="body">
        <div class="form-grid two-cols">
          <div class="field">
            <label>ุงุฎุชุฑ ุงูุฏูุฑ</label>
            <select id="roleSelect">
              <option value="viewer">ูุดุงูุฏ (ูุฑุงุกุฉ ููุท)</option>
              <option value="editor">ูุญุฑุฑ</option>
              <option value="admin">ูุฏูุฑ</option>
            </select>
          </div>
          <div class="field">
            <label>ุงูุฑูุฒ ุงูุณุฑู (PIN)</label>
            <input id="pinInput" type="password" placeholder="ูุซุงู: 1234" />
          </div>
        </div>
        <p class="hint">ููุงุญุธุฉ: ุงูุฃุฏูุงุฑ ุชูุญูุธ ูุญูููุง ุนูู ูุฐุง ุงูุฌูุงุฒ ููุท.</p>
      </div>
      <footer>
        <button id="loginSubmit" class="save">ุฏุฎูู</button>
      </footer>
    </div>
  </div>

  <!-- ูุงูุฐุฉ ุฅุนุฏุงุฏุงุช ุงูุฃุฏูุงุฑ -->
  <div class="modal" id="acctModal">
    <div class="dialog">
      <header>
        <h3>๐ค ุฅุนุฏุงุฏุงุช ุงูุฃุฏูุงุฑ</h3>
        <button id="closeAcct" class="secondary">โ</button>
      </header>
      <div class="body">
        <div class="form-grid two-cols">
          <div class="field"><label>PIN ุงููุฏูุฑ</label><input id="pinAdmin" placeholder="ุงูุชุฑุงุถู: 0000"></div>
          <div class="field"><label>PIN ุงููุญุฑุฑ</label><input id="pinEditor" placeholder="ุงูุชุฑุงุถู: 1111"></div>
        </div>
        <p class="hint">ุงุชุฑู ุงูุญูู ูุงุฑุบูุง ููุฅุจูุงุก ุนูู ุงููููุฉ ุงูุญุงููุฉ. ุชูุญูุธ ุงูุฅุนุฏุงุฏุงุช ูุญูููุง.</p>
      </div>
      <footer>
        <button id="resetPIN" class="danger">๐ ุฅุนุงุฏุฉ ุชุนููู PIN</button>
        <button id="saveAcct" class="save">ุญูุธ</button>
      </footer>
    </div>
  </div>

</body>
</html>
